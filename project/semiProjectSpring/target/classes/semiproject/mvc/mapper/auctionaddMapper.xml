<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="auction">
	<insert id="addmian" parameterType="amainvo">
		insert into actmain values(actmain_seq.nextVal,#{bid},#{byongdo},#{baddra},#{baddrb},#{bzipcode},#{bweight},#{tweight},0,sysdate,null)
	</insert>
	<insert id="addde" parameterType="adevo">
		insert into actmainde values(actmainde_seq.nextVal,actmain_seq.currVal,#{managepee},#{bplan},#{wimage},#{imagea},#{imageb},#{imagec},sysdate,null)
	</insert>
	<insert id="addip" parameterType="aipvo">
		insert into ipchal values(ipchal_seq.nextVal,actmain_seq.currVal,TO_DATE(#{enddate},'YYYY-MM-DD HH:MI:SS'),#{ipdanwe},#{ideprice},0,#{subject},#{text},sysdate,null)
	</insert>
	
	<select id="mainsel" resultType="aviewmain" parameterType="aviewpage">
	select * from (
		select rownum r_num, a.* from (
		select a.anum,a.bid,fn_yongdo_name(a.byongdo) as yongdo,a.baddra as addr,a.bweight,a.tweight,a.hit,b.wimage,p.ideprice,p.subject,p.enddate,nvl(fn_higt_ipchalper(p.ipnum),0)  as hprice  
 from actmain a , actmainde b , ipchal p
where b.anum = a.anum
  and p.anum = a.anum
order by a.indate desc
		) a
		) where r_num between #{start} and #{end}
	</select>
	<select id="totalcount" resultType="int">
	select count(a.anum) as cnt  
      from actmain a , actmainde b , ipchal p
     where b.anum = a.anum
       and p.anum = a.anum
	</select>
</mapper>



